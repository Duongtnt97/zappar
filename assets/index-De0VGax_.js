import{r as e}from"./rolldown-runtime-DGruFWvd.js";import{a as t,c as n,d as r,f as i,i as a,l as o,n as s,o as c,r as l,s as u,t as d,u as f}from"./vendor-C5pHgnko.js";(function(){let e=document.createElement(`link`).relList;if(e&&e.supports&&e.supports(`modulepreload`))return;for(let e of document.querySelectorAll(`link[rel="modulepreload"]`))n(e);new MutationObserver(e=>{for(let t of e)if(t.type===`childList`)for(let e of t.addedNodes)e.tagName===`LINK`&&e.rel===`modulepreload`&&n(e)}).observe(document,{childList:!0,subtree:!0});function t(e){let t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),e.crossOrigin===`use-credentials`?t.credentials=`include`:e.crossOrigin===`anonymous`?t.credentials=`omit`:t.credentials=`same-origin`,t}function n(e){if(e.ep)return;e.ep=!0;let n=t(e);fetch(e.href,n)}})();var p=r(),m=e(i(),1),h=u(),g=({zptUrl:e,videoUrl:t,onStatusChange:r})=>{let i=(0,m.useRef)(),u=(0,m.useRef)(),p=(0,m.useRef)(),[g,_]=(0,m.useState)(null),[v,y]=(0,m.useState)(null),[b,x]=(0,m.useState)(null);return(0,m.useEffect)(()=>{let t=new a,n=new d(t);return x(t),y(n),l().then(()=>n.start()),fetch(e).then(t=>{if(!t.ok)throw Error(`Failed to load ${e}: ${t.status}`);return t.arrayBuffer()}).then(e=>{let n=new s(t);n.loadFromBuffer(e),_(n)}).catch(e=>console.error(`ZPT load error:`,e)),()=>{n?.stop(),t?.destroy()}},[e]),(0,m.useEffect)(()=>{let e=document.createElement(`video`);e.crossOrigin=`anonymous`,e.playsInline=!0,e.muted=!0,e.loop=!0,e.preload=`auto`,e.src=t;let r=new f(e);return r.minFilter=n,r.magFilter=n,r.colorSpace=o,p.current=r,u.current=e,e.load(),()=>{p.current&&p.current.dispose()}},[t]),c(()=>{if(!i.current||!g||!v)return;let e=g.anchor,t=u.current,n=i.current;if(e?.isTracking){let i=e.getPose(v);n.position.copy(i.position),n.quaternion.copy(i.quaternion);let a=.15;n.scale.set(a,a,a),n.visible=!0,t&&t.paused&&t.readyState>=t.HAVE_ENOUGH_DATA&&t.play().catch(e=>console.warn(`Autoplay prevented:`,e)),r?.(`tracking`)}else n.visible=!1,t&&!t.paused&&t.pause(),r?.(`lost`)}),(0,h.jsx)(`group`,{ref:i,visible:!1,rotation:[0,Math.PI,0],children:(0,h.jsxs)(`mesh`,{children:[(0,h.jsx)(`planeGeometry`,{args:[1,.5625]}),` `,(0,h.jsx)(`meshBasicMaterial`,{map:p.current,toneMapped:!1,transparent:!0})]})})},_=()=>(0,h.jsxs)(`div`,{style:{position:`absolute`,top:`20px`,left:`20px`,right:`20px`,zIndex:1e3,background:`rgba(0, 0, 0, 0.7)`,color:`white`,padding:`15px`,borderRadius:`10px`,fontSize:`14px`,fontFamily:`Arial, sans-serif`},children:[(0,h.jsx)(`h3`,{style:{margin:`0 0 10px 0`,fontSize:`16px`},children:`ðŸŽ¯ AR Video Player`}),(0,h.jsxs)(`p`,{style:{margin:`5px 0`},children:[`ðŸ“± `,(0,h.jsx)(`strong`,{children:`HÆ°á»›ng camera vá» image target`}),` Ä‘á»ƒ xem video AR`]}),(0,h.jsxs)(`p`,{style:{margin:`5px 0`,fontSize:`12px`,opacity:.8},children:[`â€¢ Target: `,(0,h.jsx)(`code`,{children:`public/targets/target.zpt`}),` âœ…`,(0,h.jsx)(`br`,{}),`â€¢ Video: `,(0,h.jsx)(`code`,{children:`public/videos/Facebook.mp4`}),` âœ…`]})]}),v=({onTargetFound:e,onTargetLost:t})=>{let[n,r]=(0,m.useState)(`initializing`),[i,a]=(0,m.useState)(null);return(0,m.useEffect)(()=>{if(!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia){a(`Camera khÃ´ng Ä‘Æ°á»£c há»— trá»£ trÃªn browser nÃ y`);return}if(location.protocol!==`https:`&&!location.hostname.includes(`localhost`)){a(`Cáº§n HTTPS Ä‘á»ƒ truy cáº­p camera`);return}r(`ready`)},[]),i?(0,h.jsxs)(`div`,{style:{position:`absolute`,top:`50%`,left:`50%`,transform:`translate(-50%, -50%)`,zIndex:1e3,background:`rgba(244, 67, 54, 0.9)`,color:`white`,padding:`20px`,borderRadius:`10px`,textAlign:`center`,maxWidth:`300px`},children:[(0,h.jsx)(`h3`,{children:`âŒ Lá»—i`}),(0,h.jsx)(`p`,{children:i}),(0,h.jsx)(`small`,{children:location.protocol!==`https:`&&!location.hostname.includes(`localhost`)?`HÃ£y deploy lÃªn Vercel/Netlify hoáº·c dÃ¹ng ngrok`:`Kiá»ƒm tra camera permission trong browser`})]}):(0,h.jsx)(`div`,{style:{position:`absolute`,bottom:`20px`,left:`50%`,transform:`translateX(-50%)`,zIndex:1e3,background:`rgba(0, 0, 0, 0.8)`,color:`white`,padding:`10px 20px`,borderRadius:`25px`,fontSize:`14px`,fontFamily:`Arial, sans-serif`,border:`2px solid ${(()=>{switch(n){case`tracking`:return`#4CAF50`;case`lost`:return`#FF9800`;case`ready`:return`#2196F3`;default:return`#666`}})()}`,transition:`all 0.3s ease`},children:(()=>{switch(n){case`initializing`:return`ðŸ”„ Äang khá»Ÿi táº¡o AR...`;case`ready`:return`ðŸ“± HÆ°á»›ng camera vá» image target`;case`tracking`:return`ðŸŽ¯ Äang tracking - Video Ä‘ang phÃ¡t!`;case`lost`:return`âŒ Máº¥t target - Di chuyá»ƒn camera vá» target`;default:return`âš¡ AR Video Player`}})()})},y=({show:e=!1})=>{let[t,n]=(0,m.useState)({userAgent:navigator.userAgent,isHTTPS:location.protocol===`https:`,isLocalhost:location.hostname.includes(`localhost`),hasCamera:!!navigator.mediaDevices?.getUserMedia,screenSize:`${window.innerWidth}x${window.innerHeight}`,timestamp:new Date().toLocaleTimeString()});return(0,m.useEffect)(()=>{let e=setInterval(()=>{n(e=>({...e,timestamp:new Date().toLocaleTimeString()}))},1e3);return()=>clearInterval(e)},[]),e?(0,h.jsxs)(`div`,{style:{position:`absolute`,top:`20px`,right:`20px`,zIndex:1001,background:`rgba(0, 0, 0, 0.9)`,color:`#00ff00`,padding:`10px`,borderRadius:`5px`,fontSize:`11px`,fontFamily:`monospace`,maxWidth:`300px`,border:`1px solid #333`},children:[(0,h.jsx)(`div`,{style:{color:`#fff`,marginBottom:`5px`,fontWeight:`bold`},children:`ðŸ”§ Debug Info`}),(0,h.jsxs)(`div`,{children:[`ðŸ“± Screen: `,t.screenSize]}),(0,h.jsxs)(`div`,{children:[`ðŸ”’ HTTPS: `,t.isHTTPS?`âœ…`:`âŒ`]}),(0,h.jsxs)(`div`,{children:[`ðŸ  Localhost: `,t.isLocalhost?`âœ…`:`âŒ`]}),(0,h.jsxs)(`div`,{children:[`ðŸ“· Camera API: `,t.hasCamera?`âœ…`:`âŒ`]}),(0,h.jsxs)(`div`,{children:[`â° Time: `,t.timestamp]}),(0,h.jsxs)(`div`,{style:{marginTop:`5px`,fontSize:`10px`,opacity:.7},children:[`Target: /targets/target.zpt`,(0,h.jsx)(`br`,{}),`Video: /videos/Facebook.mp4`]})]}):null},b=({show:e=!1})=>{let[t,n]=(0,m.useState)({localhost:`http://localhost:5173`,network:`Äang tÃ¬m...`,qrCode:null});(0,m.useEffect)(()=>{if(window.location.hostname!==`localhost`&&window.location.hostname!==`127.0.0.1`){let e=`${window.location.protocol}//${window.location.host}`;n(t=>({...t,network:e}))}},[]);let r=e=>{navigator.clipboard.writeText(e).then(()=>{alert(`ÄÃ£ copy link!`)}).catch(()=>{let t=document.createElement(`textarea`);t.value=e,document.body.appendChild(t),t.select(),document.execCommand(`copy`),document.body.removeChild(t),alert(`ÄÃ£ copy link!`)})};return e?(0,h.jsxs)(`div`,{style:{position:`absolute`,bottom:`80px`,left:`20px`,right:`20px`,zIndex:1001,background:`rgba(0, 0, 0, 0.9)`,color:`white`,padding:`15px`,borderRadius:`10px`,fontSize:`13px`,fontFamily:`Arial, sans-serif`,border:`1px solid #333`},children:[(0,h.jsx)(`div`,{style:{color:`#4CAF50`,marginBottom:`10px`,fontWeight:`bold`},children:`ðŸŒ Network Links`}),(0,h.jsxs)(`div`,{style:{marginBottom:`8px`},children:[(0,h.jsx)(`strong`,{children:`ðŸ’» Desktop:`}),(0,h.jsxs)(`div`,{style:{background:`rgba(255,255,255,0.1)`,padding:`5px`,borderRadius:`3px`,marginTop:`3px`,cursor:`pointer`,fontSize:`12px`},onClick:()=>r(t.localhost),children:[t.localhost,` ðŸ“‹`]})]}),(0,h.jsxs)(`div`,{style:{marginBottom:`8px`},children:[(0,h.jsx)(`strong`,{children:`ðŸ“± Mobile/Tablet:`}),(0,h.jsxs)(`div`,{style:{background:`rgba(255,255,255,0.1)`,padding:`5px`,borderRadius:`3px`,marginTop:`3px`,cursor:`pointer`,fontSize:`12px`},onClick:()=>r(t.network),children:[t.network,` ðŸ“‹`]})]}),(0,h.jsxs)(`div`,{style:{fontSize:`11px`,opacity:.7,marginTop:`10px`},children:[`ðŸ’¡ `,(0,h.jsx)(`strong`,{children:`LÆ°u Ã½:`}),(0,h.jsx)(`br`,{}),`â€¢ Desktop: DÃ¹ng localhost`,(0,h.jsx)(`br`,{}),`â€¢ Mobile: Cáº§n network IP (cháº¡y `,(0,h.jsx)(`code`,{children:`npm run dev`}),` Ä‘á»ƒ xem)`,(0,h.jsx)(`br`,{}),`â€¢ Mobile cáº§n HTTPS cho camera (deploy production)`]})]}):null},x=({show:e=!1})=>{let[t,n]=(0,m.useState)({target:`checking`,video:`checking`,zappar:`checking`});(0,m.useEffect)(()=>{e&&(async()=>{try{let e=await fetch(`/targets/target.zpt`);n(t=>({...t,target:e.ok?`ok`:`error`}))}catch{n(e=>({...e,target:`error`}))}try{let e=await fetch(`/videos/Facebook.mp4`,{method:`HEAD`});n(t=>({...t,video:e.ok?`ok`:`error`}))}catch{n(e=>({...e,video:`error`}))}try{let e=await fetch(`/assets/zappar-cv-Ca4h5Ys_.wasm`,{method:`HEAD`});n(t=>({...t,zappar:e.ok?`ok`:`error`}))}catch{n(e=>({...e,zappar:`error`}))}})()},[e]);let r=e=>{switch(e){case`ok`:return`âœ…`;case`error`:return`âŒ`;case`checking`:return`ðŸ”„`;default:return`â“`}},i=e=>{switch(e){case`ok`:return`#4CAF50`;case`error`:return`#f44336`;case`checking`:return`#FF9800`;default:return`#666`}};return e?(0,h.jsxs)(`div`,{style:{position:`absolute`,bottom:`140px`,right:`20px`,zIndex:1001,background:`rgba(0, 0, 0, 0.9)`,color:`white`,padding:`15px`,borderRadius:`10px`,fontSize:`13px`,fontFamily:`Arial, sans-serif`,border:`1px solid #333`,minWidth:`200px`},children:[(0,h.jsx)(`div`,{style:{color:`#2196F3`,marginBottom:`10px`,fontWeight:`bold`},children:`ðŸ“¦ Asset Status`}),(0,h.jsxs)(`div`,{style:{marginBottom:`5px`},children:[(0,h.jsx)(`span`,{style:{color:i(t.target)},children:r(t.target)}),` `,`Target (.zpt): `,t.target]}),(0,h.jsxs)(`div`,{style:{marginBottom:`5px`},children:[(0,h.jsx)(`span`,{style:{color:i(t.video)},children:r(t.video)}),` `,`Video (.mp4): `,t.video]}),(0,h.jsxs)(`div`,{style:{marginBottom:`10px`},children:[(0,h.jsx)(`span`,{style:{color:i(t.zappar)},children:r(t.zappar)}),` `,`Zappar (.wasm): `,t.zappar]}),Object.values(t).includes(`error`)&&(0,h.jsxs)(`div`,{style:{fontSize:`11px`,opacity:.8,marginTop:`10px`,padding:`8px`,background:`rgba(244, 67, 54, 0.2)`,borderRadius:`5px`},children:[`âš ï¸ Má»™t sá»‘ assets bá»‹ lá»—i.`,(0,h.jsx)(`br`,{}),`Thá»­: Rebuild project hoáº·c kiá»ƒm tra network`]})]}):null},S=()=>{let[e,n]=(0,m.useState)(`ready`),[r,i]=(0,m.useState)(!1),[a,o]=(0,m.useState)(!1),s=new URLSearchParams(window.location.search).get(`debug`)===`1`;return(0,h.jsxs)(`div`,{style:{position:`relative`,width:`100vw`,height:`100vh`},children:[(0,h.jsx)(_,{}),(0,h.jsx)(v,{}),(0,h.jsx)(y,{show:s}),(0,h.jsx)(b,{show:r}),(0,h.jsx)(x,{show:a}),(0,h.jsx)(`button`,{onClick:()=>i(!r),style:{position:`absolute`,top:`20px`,right:`20px`,zIndex:1002,background:r?`#4CAF50`:`rgba(0, 0, 0, 0.7)`,color:`white`,border:`1px solid #333`,borderRadius:`50%`,width:`50px`,height:`50px`,fontSize:`20px`,cursor:`pointer`,display:`flex`,alignItems:`center`,justifyContent:`center`},title:`Network Links`,children:`ðŸŒ`}),(0,h.jsx)(`button`,{onClick:()=>o(!a),style:{position:`absolute`,top:`80px`,right:`20px`,zIndex:1002,background:a?`#4CAF50`:`rgba(0, 0, 0, 0.7)`,color:`white`,border:`1px solid #333`,borderRadius:`50%`,width:`50px`,height:`50px`,fontSize:`20px`,cursor:`pointer`,display:`flex`,alignItems:`center`,justifyContent:`center`},title:`Check Assets`,children:`ðŸ“¦`}),(0,h.jsx)(t,{camera:{near:.01,far:1e3},gl:{antialias:!0,alpha:!0},style:{width:`100vw`,height:`100vh`,background:`black`},children:(0,h.jsx)(g,{zptUrl:`/targets/target.zpt`,videoUrl:`/videos/Facebook.mp4`,onStatusChange:n})})]})},C=class extends m.Component{constructor(e){super(e),this.state={hasError:!1,error:null}}static getDerivedStateFromError(e){return{hasError:!0,error:e}}componentDidCatch(e,t){console.error(`AR Error:`,e,t)}render(){return this.state.hasError?(0,h.jsxs)(`div`,{style:{position:`absolute`,top:`50%`,left:`50%`,transform:`translate(-50%, -50%)`,zIndex:1e3,background:`rgba(244, 67, 54, 0.9)`,color:`white`,padding:`20px`,borderRadius:`10px`,textAlign:`center`,maxWidth:`400px`},children:[(0,h.jsx)(`h3`,{children:`âŒ AR Loading Error`}),(0,h.jsx)(`p`,{children:`KhÃ´ng thá»ƒ táº£i AR components`}),(0,h.jsxs)(`details`,{style:{marginTop:`15px`,textAlign:`left`},children:[(0,h.jsx)(`summary`,{style:{cursor:`pointer`,marginBottom:`10px`},children:`ðŸ”§ Chi tiáº¿t lá»—i`}),(0,h.jsx)(`pre`,{style:{fontSize:`12px`,background:`rgba(0,0,0,0.3)`,padding:`10px`,borderRadius:`5px`,overflow:`auto`,maxHeight:`200px`},children:this.state.error?.toString()})]}),(0,h.jsxs)(`div`,{style:{marginTop:`15px`},children:[(0,h.jsx)(`button`,{onClick:()=>window.location.reload(),style:{background:`#4CAF50`,color:`white`,border:`none`,padding:`10px 20px`,borderRadius:`5px`,cursor:`pointer`,marginRight:`10px`},children:`ðŸ”„ Reload`}),(0,h.jsx)(`button`,{onClick:()=>window.open(`/test-video.html`,`_blank`),style:{background:`#2196F3`,color:`white`,border:`none`,padding:`10px 20px`,borderRadius:`5px`,cursor:`pointer`},children:`ðŸ§ª Test Video`})]}),(0,h.jsx)(`div`,{style:{fontSize:`12px`,marginTop:`15px`,opacity:.8},children:`ðŸ’¡ Thá»­: Reload page, kiá»ƒm tra network, hoáº·c test video trÆ°á»›c`})]}):this.props.children}};function w(){return(0,h.jsx)(`div`,{style:{width:`100vw`,height:`100vh`,margin:0,padding:0},children:(0,h.jsx)(C,{children:(0,h.jsx)(S,{})})})}var T=w;(0,p.createRoot)(document.getElementById(`root`)).render((0,h.jsx)(m.StrictMode,{children:(0,h.jsx)(T,{})}));